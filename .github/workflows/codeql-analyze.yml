name: CodeQL Analysis

#run-name: ${{ github.repository }} is evaluating pull request

on:
  # REMOVEME
  #workflow_dispatch:

  # Specify an on.push hook to analyze and see code scanning alerts from the default branch on the Security tab.
  push:
#    branches: [main]

  pull_request:
#    branches: [main]

permissions:
  # to fetch code (actions/checkout)
  contents: read
  # https://github.com/marketplace/actions/publish-test-results#permissions
  # https://github.com/marketplace/actions/junit-report-action
  checks: write
  pull-requests: write # only required if `comment: true` was enabled
  # Required to upload SARIF file to CodeQL. See: https://github.com/github/codeql-action/issues/2117
  actions: read
  # Require writing security events to upload SARIF file to security tab
  # As described at https://github.com/github/codeql-action?tab=readme-ov-file#workflow-permissions
  security-events: write

jobs:
  rust-codeql-analyze:
    name: Analyze code (CodeQL)
    # just reuse a relevant workflow from the dedicated repo https://github.com/swiyu-admin-ch/github-actions-workflows
    uses: swiyu-admin-ch/github-actions-workflows/.github/workflows/rust-codeql-analyze.yml@main
    #uses: swiyu-admin-ch/github-actions-workflows/.github/workflows/rust-codeql-analyze.yml@feat/EIDOMNI-262-rust-pull-request-check